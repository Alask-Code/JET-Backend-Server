var $jscomp$this=this,$jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};exports.wipeDepend=function(a){return JSON.parse(JSON.stringify(a))};
exports.getCookies=function(a){var b={};if(a=a.headers.cookie){a=$jscomp.makeIterator(a.split(";"));for(var c=a.next();!c.done;c=a.next())c=c.value.split("="),b[c.shift().trim()]=decodeURI(c.join("="))}return b};exports.clearString=function(a){return a.replace(/[\b]/g,"").replace(/[\f]/g,"").replace(/[\n]/g,"").replace(/[\r]/g,"").replace(/[\t]/g,"").replace(/[\\]/g,"")};
exports.getRandomInt=function(a,b){a=Math.ceil(void 0===a?0:a);b=Math.floor(void 0===b?100:b);return b>a?Math.floor(Math.random()*(b-a+1)+a):a};exports.getRandomIntEx=function(a){return 1<a?Math.floor(Math.random()*(a-2)+1):1};exports.getDirList=function(a){return fileIO.readDir(a).filter(function(b){return fileIO.statSync(a+"/"+b).isDirectory()})};
exports.removeDir=function(a){for(var b=$jscomp.makeIterator(fileIO.readDir(a)),c=b.next();!c.done;c=b.next())file=c.value,c=internal.path.join(a,file),fileIO.lstatSync(c).isDirectory()?$jscomp$this.removeDir(c):fileIO.unlink(c);fileIO.rmDir(a)};exports.getServerUptimeInSeconds=function(){return Math.floor(internal.process.uptime())};exports.getTimestamp=function(){return Math.floor((new Date).getTime()/1E3)};exports.getTime=function(){return $jscomp$this.formatTime(new Date)};
exports.formatTime=function(a){var b=("0"+a.getHours()).substr(-2),c=("0"+a.getMinutes()).substr(-2);a=("0"+a.getSeconds()).substr(-2);return b+"-"+c+"-"+a};exports.getDate=function(){return $jscomp$this.formatDate(new Date)};exports.formatDate=function(a){var b=("0"+a.getDate()).substr(-2),c=("0"+(a.getMonth()+1)).substr(-2);return a.getFullYear()+"-"+c+"-"+b};
exports.makeSign=function(a){for(var b="",c=0;c<a;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return b};exports.generateNewAccountId=function(){return $jscomp$this.generateNewId("AID",!0)};exports.generateNewItemId=function(){return $jscomp$this.generateNewId("I")};exports.generateNewDialogueId=function(){return $jscomp$this.generateNewId("D")};var $jscomp$destructuring$var0=require("uuid"),uuidv4=$jscomp$destructuring$var0.v4;
exports.generateNewId=function(a,b){a=void 0===a?"":a;var c=new Date;(void 0===b?0:b)?(a+=c.getMonth().toString(),a+=c.getDate().toString(),a+=c.getHours().toString(),a+=(parseInt(c.getMinutes())+parseInt(c.getSeconds())).toString(),a+=$jscomp$this.getRandomInt(1E6,9999999).toString(),a+=$jscomp$this.makeSign(24-a.length).toString()):a=a+"-"+uuidv4();return a};
exports.secondsToTime=function(a){a=Math.round(a);var b=Math.floor(a/60/60),c=Math.floor(a/60)-60*b;a%=60;10>c&&(c="0"+c);10>a&&(a="0"+a);return b+"h"+c+":"+a};exports.isUndefined=function(a){return"undefined"==typeof a};exports.getArrayValue=function(a){return a[utility.getRandomInt(0,a.length-1)]};
exports.generateInventoryID=function(a){for(var b={},c={},e="",f=$jscomp.makeIterator(a.Inventory.items),d=f.next();!d.done;d=f.next())d=d.value,c[d._id]=d,"55d7217a4bdc2d86028b456d"===d._tpl?e=d._id:"parentId"in d&&(d.parentId in b||(b[d.parentId]=[]),b[d.parentId].push(d));f=utility.generateNewItemId();c[e]._id=f;a.Inventory.equipment=f;if(e in b)for(b=$jscomp.makeIterator(b[e]),d=b.next();!d.done;d=b.next())d.value.parentId=f;return a};
exports.splitStack=function(a){if(!("upd"in a&&"StackObjectsCount"in a.upd))return[a];var b=global._database.items[a._tpl]._props.StackMaxSize,c=a.upd.StackObjectsCount,e=[];if(c<=b)return e.push(utility.wipeDepend(a)),e;for(;c;){var f=Math.min(c,b),d=utility.wipeDepend(a);d._id=utility.generateNewItemId();d.upd.StackObjectsCount=f;c-=f;e.push(d)}return e};